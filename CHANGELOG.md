# Changelog

## [0.6.0] - 2026-01-23

### Novidades
- feat: Upgrade hash visual de 64-bit para 1024-bit e corre√ß√µes gerais (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/6429ee53681a1ca15aefca3928c0403e51da2e71))

### Documenta√ß√£o
- docs: Adiciona plano detalhado de otimiza√ß√µes (OTIMIZACOES.md) (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/cc15780634b2fa562035a2467785b2ae31df568a))
- docs(changelog): atualiza√ß√µes de 2026-01-23 (por github-actions[bot]) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/35ae81c99dfb8a4b8210115ad5af5861ac0b00d2))

## [0.6.0] - 2026-01-23

### Novidades
- feat: Upgrade hash visual de 64-bit para 1024-bit e corre√ß√µes gerais (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/6429ee53681a1ca15aefca3928c0403e51da2e71))

## [0.6.0] - 2026-01-21

### Documenta√ß√£o
- docs(changelog): atualiza√ß√µes de 2026-01-20 (por github-actions[bot]) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/55101fa28dbd57fa306aaaeda1629cd97ef19483))

## [0.6.0] - 2026-01-20

### Documenta√ß√£o
- docs(changelog): atualiza√ß√µes de 2026-01-19 (por github-actions[bot]) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/0d1b48d75eaf10279938d8940465684395aa493d))

## [0.6.0] - 2026-01-19

### Novidades
- feat: Sistema de notifica√ß√£o de vers√£o e workflow autom√°tico (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/6a7d6c3b0591b8c23223d4da230ad568e1782a4b))

### Corre√ß√µes
- fix: Remove permiss√£o inv√°lida 'metadata' do workflow (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/29353428bfbd7d70dabc5013891bfe5fa2abd4b4))
- fix: Filtra hashes degenerados no backfill de m√≠dia animada (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/6966e5b5f264a595e68bf3228e3a792298f42965))
- fix: Melhora detec√ß√£o de hashes degenerados (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/749d8577652836f0b7d24ee309c50fc8270a074c))
- fix: Ignora hashes degenerados na compara√ß√£o de similaridade (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/cb119315a4312b81a95a40f5747066c0fe30e4b2))
- fix: Corrige hammingDistance para suportar hashes multi-frame (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/ec875913d452fa4167754babddf0a9399a30d678))
- fix: Corrige erro de coluna updated_at na tabela bot_config (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/6e0aa6730948f38a980dcb85cf871bef152f68d9))
- fix: Atualiza script de vers√£o para seguir Conventional Commits (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/09ef2c00026b753d5c563fa12fc345e23dd18192))

### Documenta√ß√£o
- docs(changelog): atualiza√ß√µes de 2026-01-18 (por github-actions[bot]) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/49ddb37c4a5d27245399fcf5266073be0a7a593b))

### Outros
- Implementa contagem de rea√ß√µes para stickers e permiss√µes de comandos por grupo (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/24ddba264b64ccfa23e8a71db1d110a75a5cde09))
- Melhora performance do web server (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/ca9c6e52327d231628529c864592f590c22e09a8))
- Remove men√ß√µes de usu√°rios e usa primeira pessoa nas respostas do bot (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/e23c086b197ebca677f273375714de90ef0d4a37))
- Implementa detec√ß√£o de duplicatas por dist√¢ncia de Hamming (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/486bc93242496df0a24e8103a2fcdc7cd09d0ba4))
- Add CLAUDE.md for Claude Code guidance (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/4a5aaeeb153b46475e17f48e753b92bbf55923bc))

## [0.6.0] - 2026-01-18

### Novidades
- feat: Sistema de notifica√ß√£o de vers√£o e workflow autom√°tico (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/6a7d6c3b0591b8c23223d4da230ad568e1782a4b))

### Corre√ß√µes
- fix: Remove permiss√£o inv√°lida 'metadata' do workflow (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/29353428bfbd7d70dabc5013891bfe5fa2abd4b4))
- fix: Filtra hashes degenerados no backfill de m√≠dia animada (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/6966e5b5f264a595e68bf3228e3a792298f42965))
- fix: Melhora detec√ß√£o de hashes degenerados (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/749d8577652836f0b7d24ee309c50fc8270a074c))
- fix: Ignora hashes degenerados na compara√ß√£o de similaridade (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/cb119315a4312b81a95a40f5747066c0fe30e4b2))
- fix: Corrige hammingDistance para suportar hashes multi-frame (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/ec875913d452fa4167754babddf0a9399a30d678))
- fix: Corrige erro de coluna updated_at na tabela bot_config (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/6e0aa6730948f38a980dcb85cf871bef152f68d9))
- fix: Atualiza script de vers√£o para seguir Conventional Commits (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/09ef2c00026b753d5c563fa12fc345e23dd18192))

### Outros
- Implementa contagem de rea√ß√µes para stickers e permiss√µes de comandos por grupo (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/24ddba264b64ccfa23e8a71db1d110a75a5cde09))
- Melhora performance do web server (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/ca9c6e52327d231628529c864592f590c22e09a8))
- Remove men√ß√µes de usu√°rios e usa primeira pessoa nas respostas do bot (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/e23c086b197ebca677f273375714de90ef0d4a37))
- Implementa detec√ß√£o de duplicatas por dist√¢ncia de Hamming (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/486bc93242496df0a24e8103a2fcdc7cd09d0ba4))
- Add CLAUDE.md for Claude Code guidance (por root) ([link](https://github.com/ZanardiZZ/sticker-bot/commit/4a5aaeeb153b46475e17f48e753b92bbf55923bc))

> Log de mudan√ßas com foco em usu√°rios: novidades, corre√ß√µes e melhorias relevantes.

## [0.5.0] - 2025-11-13

### üîß Sistema de Versionamento

- **Novo sistema de versionamento autom√°tico** - Vers√£o agora inicia em 0.5 e incrementa automaticamente
  - Auto-incremento de 0.1 (minor version) a cada gera√ß√£o de changelog
  - **Suporte para patch-only updates** - Use a palavra `patch` no commit para incrementar apenas o patch (0.5.0 ‚Üí 0.5.1)
  - Suporte para bump manual via commit messages (e.g., `bump: version 1.0`)
  - Hist√≥rico de vers√µes armazenado no banco de dados
  - Integra√ß√£o com workflow de changelog di√°rio
  - Script `scripts/increment-version.js` para gerenciamento manual
  - Documenta√ß√£o completa em `docs/VERSION_MANAGEMENT.md`

### üìù Detalhes T√©cnicos

- Vers√µes armazenadas na tabela `version_info` do banco de dados
- Formato: `major.minor.patch` (ex: 0.5.0, 0.5.1, 0.6.0, 1.0.0)
- Workflow do GitHub Actions atualizado para incrementar vers√£o antes do changelog
- Testes unit√°rios adicionados para validar incremento de vers√£o
- Package.json sincronizado automaticamente com vers√£o do banco
- Patch updates n√£o resetam a vers√£o minor (ideal para pequenos fixes)

## [1.0.0] - 2025

### üöÄ Major Changes

#### Migration to Baileys
- **Migrated from OpenWA to Baileys** - WhatsApp library upgrade for better stability and support
- **WebSocket Bridge Architecture** - Separated WhatsApp session from bot logic
  - Start bridge: `npm run baileys:server`
  - Start bot: `npm run bot`
  - Restart bot without rescanning QR code
- **Persistent Sessions** - Session data stored in `auth_info_baileys/`

### ‚ú® New Commands

#### Media Commands
- **#criar** - Generate memes using AI (DALL-E integration)
- **#exportarmemes** - Export all generated memes (admin only)
- **#fotohd** - Upscale photos to HD quality using AI
- **#downloadmp3** / **#baixarmp3** / **#baixaraudio** - Download audio from video URLs

#### Utility Commands
- **#perfil** - Show user profile and statistics
- **#ping** - Check bot status, uptime, and version
- **#tema** - Get random sticker by theme/topic
- **#issue** - Report issues to developers

#### Moderation Commands
- **#deletar** - Delete sticker by ID using voting system (3 votes, or immediate for original sender/admins)

### üé® Features

#### AI Integration
- **Automatic tagging** - AI-powered content analysis and tagging
- **Audio transcription** - OpenAI Whisper integration for voice messages
- **Image upscaling** - HD photo enhancement
- **Meme generation** - AI-generated memes from text prompts
- **NSFW filtering** - Automatic content moderation with external providers

#### Media Processing
- **Animated WebP support** - Process animated stickers with Sharp
- **GIF optimization** - Automatic conversion and size optimization
- **Video downloads** - Support for YouTube, TikTok, Instagram, Twitter, and more
- **Audio extraction** - Download audio from video platforms
- **Queue system** - High-volume media processing with retry logic

#### Web Interface
- **User verification** - Link WhatsApp account to web account with `#verificar`
- **Analytics dashboard** - Usage statistics and user rankings
- **Duplicate management** - Detect and remove duplicate media
- **IP rules** - Allow/block specific IP addresses
- **Command usage tracking** - `#top5comandos` ranking

#### Database & Performance
- **WAL mode** - Better concurrency for SQLite
- **Contact migration** - Historical sender ID migration tools
- **LID support** - WhatsApp's new Local Identifier system
- **Automatic retries** - Handle SQLITE_BUSY errors gracefully

### üõ°Ô∏è Security & Moderation

- **Rate limiting** - Protection against abuse
- **Request logging** - Detailed analytics and monitoring
- **Ban command** - Remove users from groups (`#ban @user`)
- **Force save** - Admin override for media processing
- **NSFW detection** - Multiple providers (HuggingFace, OpenAI, local TensorFlow)

### üîß Configuration

#### New Environment Variables
- `BAILEYS_WS_PORT` - WebSocket bridge port (default: 8765)
- `BAILEYS_WS_URL` - Bridge URL for bot connection
- `BAILEYS_CLIENT_TOKEN` - Authentication token
- `OPENAI_API_KEY_MEMECREATOR` - Dedicated key for meme generation
- `MEME_IMAGE_SIZE` - Image dimensions (default: 1024x1024)
- `MEME_IMAGE_QUALITY` - Quality setting (default: low)
- `NSFW_EXTERNAL_PROVIDER` - External NSFW detection providers
- `HUGGINGFACE_API_KEY` - HuggingFace API integration
- `DISABLE_MULTIFRAME_WEBP_ANALYSIS` - Disable multi-frame analysis

### üêõ Bug Fixes

- **Large GIF conversion** - Fixed conversion failing on large files
- **LID counter** - Fixed sticker counter after WhatsApp LID migration
- **Animated WebP processing** - Replaced FFmpeg with Sharp for better support
- **Multi-frame analysis** - Optional disable to prevent resource contention
- **Missing sender IDs** - Migration tool for historical data

### üìö Documentation

- **Updated README** - Reflects Baileys architecture and new commands
- **Legacy documentation** - Socket Mode guides marked as legacy
- **Command guides** - Detailed usage for all commands
- **Migration guides** - Database migration documentation
- **Testing docs** - Integration and unit test documentation

### üóëÔ∏è Deprecated

- **OpenWA library** - Completely removed in favor of Baileys
- **Socket.IO mode** - Legacy open-wa socket mode no longer supported
- **Direct mode** - Replaced by WebSocket bridge architecture

---

## Migration from OpenWA

If you're upgrading from an OpenWA-based version:

1. **Backup your database** - Copy `stickers.db` to a safe location
2. **Clear old sessions** - Remove old OpenWA session directories
3. **Install dependencies** - Run `PUPPETEER_SKIP_DOWNLOAD=true npm install --ignore-scripts`
4. **Configure Baileys** - Update `.env` with Baileys settings
5. **Start bridge** - Run `npm run baileys:server` and scan QR code
6. **Start bot** - Run `npm run bot` to connect

---

For detailed information about specific features, see the [README.md](README.md) and documentation in the `docs/` directory.