# Environment Configuration for Sticker Bot

# ===== REQUIRED CONFIGURATION =====

# WhatsApp Configuration (REQUIRED)
AUTO_SEND_GROUP_ID=your_group_id_here
ADMIN_NUMBER=5511999999999@c.us

# ===== MESSAGE HISTORY RECOVERY =====

# Enable automatic recovery of missed messages (default: true)
HISTORY_RECOVERY_ENABLED=true
# Number of messages to process at once (default: 10)
HISTORY_BATCH_SIZE=10
# Maximum messages to fetch per chat (default: 50)
HISTORY_MAX_MESSAGES=50
# Specific chats to sync (comma-separated, optional - uses AUTO_SEND_GROUP_ID if not set)
# HISTORY_SYNC_CHATS=120363123456789012@g.us,120363987654321098@g.us
# Enable periodic history sync (default: false)
HISTORY_PERIODIC_SYNC=false
# Interval for periodic sync in hours (default: 24)
HISTORY_SYNC_INTERVAL_HOURS=24

# ===== BAILEYS WEBSOCKET CONFIGURATION =====

# Baileys WebSocket Bridge (default port: 8765)
# This is the bridge server that maintains the WhatsApp session
BAILEYS_WS_PORT=8765

# Authentication for the bridge (comma-separated tokens for multiple clients)
# Example: BAILEYS_ALLOWED_TOKENS=dev,prod,test
BAILEYS_ALLOWED_TOKENS=dev

# Bridge URL for bot connection (default: ws://localhost:8765)
BAILEYS_WS_URL=ws://localhost:8765

# Client authentication token (must match one from BAILEYS_ALLOWED_TOKENS)
BAILEYS_CLIENT_TOKEN=dev

# Directory for Baileys authentication data (default: auth_info_baileys)
BAILEYS_AUTH_DIR=auth_info_baileys

# ===== WEB INTERFACE CONFIGURATION =====

# Bot WhatsApp Number (for web interface buttons)
# If not set, will use ADMIN_NUMBER without @c.us suffix
BOT_WHATSAPP_NUMBER=5511999999999

# Web Interface Port
PORT=3000

# Web Server URL (for sharing pack links)
# Set this to your public URL in production (e.g., https://yourdomain.com)
WEB_SERVER_URL=http://localhost:3000

# Admin Configuration for Web Interface
ADMIN_INITIAL_USERNAME=admin
ADMIN_INITIAL_PASSWORD=your_secure_password_here

# ===== JWT AUTH (OPTIONAL) =====
# If not set, JWT will fallback to SESSION_SECRET (or a weak dev value). Define in production.
JWT_SECRET=change_me_in_production
# Token expiration (e.g. 7d, 12h, 30m)
JWT_EXPIRES_IN=7d

# Additional Admin Users (comma-separated usernames)
# ADMIN_USERS=admin2,admin3

# Session Security
# Generate a secure random key for production
SESSION_SECRET=your-secret-key-change-in-production

# ===== TIMEZONE CONFIGURATION =====

# Set the timezone for automatic sticker sending schedule (08:00-21:00)
# Default: America/Sao_Paulo
# Examples: America/Sao_Paulo, America/New_York, Europe/London, UTC
TIMEZONE=America/Sao_Paulo

# Alternative timezone setting (used if TIMEZONE is not set)
# TZ=America/Sao_Paulo

# ===== AI SERVICES (OPTIONAL) =====

# OpenAI API Key for AI-powered features
# Enables automatic tagging, transcription, and content analysis
# OPENAI_API_KEY=sk-your-openai-api-key-here

# Meme Generator configuration
# Dedicated key for meme creation to control costs
OPENAI_API_KEY_MEMECREATOR=sk-your-meme-key-here
# Default image parameters (override as needed)
MEME_IMAGE_SIZE=1024x1024
MEME_IMAGE_QUALITY=low
# Optional prompt model override
# MEME_PROMPT_MODEL=gpt-4o-mini
# Optional transcription language (ISO code)
# MEME_TRANSCRIPTION_LANGUAGE=pt

# Retry behavior for OpenAI API requests
# OPENAI_MAX_RETRIES=2
# OPENAI_RETRY_DELAY_MS=1000

# ===== ADMIN WATCHER (SELF-HEALING SYSTEM) =====

# Enable automatic problem detection and diagnosis from admin messages
# When enabled, the bot monitors admin messages for problem reports
# and automatically diagnoses/fixes issues using OpenAI GPT-4
# NOTE: Requires OPENAI_API_KEY to be set above
# Recommended: Start with false, enable after testing
ADMIN_WATCHER_ENABLED=false

# OpenAI model to use for diagnostics
# Options:
#   - gpt-4o-mini (RECOMMENDED: ~$0.60/month, fast, good diagnostics)
#   - gpt-4o (~$10/month, better diagnostics, more expensive)
#   - gpt-4-turbo-preview (expensive, only for complex issues)
# Default: gpt-4-turbo-preview (but gpt-4o-mini is recommended for cost)
ADMIN_WATCHER_MODEL=gpt-4o-mini

# Send casual acknowledgment message before diagnosing (default: true)
# Set to false to skip the "deixa eu dar uma olhada" message
# ADMIN_WATCHER_SEND_ACK=true

# Estimated costs (based on 5 diagnoses per day):
# - gpt-4o-mini: ~$0.02/day = $0.60/month ✅ RECOMMENDED
# - gpt-4o: ~$0.35/day = $10.50/month
# - gpt-4-turbo-preview: ~$1.20/day = $36/month

# ===== CONVERSATION AGENT (GROUP CHAT BOT) =====

# Enable conversational AI in group chats (default: enabled)
# Set to 0 or false to disable
CONVERSATION_AGENT_ENABLED=1

# Bot persona name (default: Lia)
CONVERSATION_PERSONA_NAME=Lia

# Aliases that trigger the bot (comma-separated, case-insensitive)
# Default: same as PERSONA_NAME
# Example: CONVERSATION_ALIASES=lia,bot,robô
# CONVERSATION_ALIASES=Lia

# Conversation behavior
CONVERSATION_HISTORY_LIMIT=16          # Messages to remember (default: 16)
CONVERSATION_COOLDOWN_MS=120000        # Min time between responses in ms (default: 2min)
CONVERSATION_MIN_MESSAGES=3            # Min messages before responding without mention (default: 3)
CONVERSATION_MAX_RESPONSE_CHARS=360    # Max response length (default: 360)
CONVERSATION_LOG_PREFILL_LIMIT=12      # Messages to prefill from logs (default: 12)

# Custom system prompt (optional)
# Use {persona} for name and {grupo}/{group} for group name
# Leave empty to use default natural prompts with random variations
# CONVERSATION_SYSTEM_PROMPT=Você é {persona}, integrante do grupo {grupo}...

# Bot self-identification (for mention detection)
# Usually auto-detected, but can be manually set if needed
# CONVERSATION_SELF_JIDS=5511999999999@s.whatsapp.net
# BOT_SELF_JIDS=5511999999999@s.whatsapp.net
# BOT_JID=5511999999999@s.whatsapp.net
# BOT_NUMBER=5511999999999

# ===== NSFW MODERATION (OPTIONAL) =====

# Use external providers for stricter NSFW detection (supports comma-separated list: huggingface,openai)
# NSFW_EXTERNAL_PROVIDER=huggingface,openai
# HUGGINGFACE_API_KEY=hf_your_api_token_here
# HUGGINGFACE_NSFWMODEL=Falconsai/nsfw_image_detection
# NSFW_EXTERNAL_MIN_SCORE=0.6
# NSFW_EXTERNAL_SAFE_SCORE=0.55
# NSFW_EXTERNAL_TIMEOUT=10000
# OPENAI_MODERATION_API_KEY=sk-openai-moderation
# OPENAI_MODERATION_MODEL=omni-moderation-latest
# NSFW_OPENAI_MIN_SCORE=0.2

# Fine-tune local fallback thresholds (optional)
# NSFW_LOCAL_PORN_THRESHOLD=0.6
# NSFW_LOCAL_HENTAI_THRESHOLD=0.6
# NSFW_LOCAL_SEXY_THRESHOLD=0.85

# ===== EMAIL SERVICE CONFIGURATION (OPTIONAL) =====

# SMTP Configuration for user email confirmations
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_SECURE=false
# SMTP_USER=your-email@gmail.com
# SMTP_PASS=your-app-password

# Email Sender Configuration
# FROM_EMAIL=noreply@yourdomain.com
# BASE_URL=https://yourdomain.com

# ===== ANALYTICS AND MONITORING (OPTIONAL) =====

# Enable internal analytics and request logging
ENABLE_INTERNAL_ANALYTICS=true

# Cloudflare Insights (if using Cloudflare)
# ALLOW_CF_INSIGHTS=1

# Umami Analytics Configuration
# UMAMI_ORIGIN=https://your-analytics-domain.com

# ===== ADVANCED CONFIGURATION =====

# Production Environment (enables security features)
# NODE_ENV=production

# Directory Configuration (usually auto-detected)
# STICKERS_DIR=/path/to/media
# PUBLIC_DIR=/path/to/web/public

# Legacy Sticker Migration
# Path to old stickers directory for migration
# OLD_STICKERS_PATH=/path/to/old/stickers

# ===== MEDIA PROCESSING CONFIGURATION =====

# Disable multi-frame analysis for animated WebP stickers (default: false)
# When enabled, animated stickers will be processed as single-frame images
# This can help diagnose FFmpeg resource contention issues
DISABLE_MULTIFRAME_WEBP_ANALYSIS=false
